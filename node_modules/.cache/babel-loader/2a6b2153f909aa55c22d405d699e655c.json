{"ast":null,"code":"var Mexp = require('./postfix.js');\n\nMexp.prototype.postfixEval = function (UserDefined) {\n  'use strict';\n\n  UserDefined = UserDefined || {};\n  UserDefined.PI = Math.PI;\n  UserDefined.E = Math.E;\n  var stack = [],\n      pop1,\n      pop2,\n      pop3;\n  var disp = [];\n  var temp = '';\n  var arr = this.value;\n  var bool = typeof UserDefined.n !== \"undefined\";\n\n  for (var i = 0; i < arr.length; i++) {\n    if (arr[i].type === 1) {\n      stack.push({\n        value: arr[i].value,\n        type: 1\n      });\n    } else if (arr[i].type === 3) {\n      stack.push({\n        value: UserDefined[arr[i].value],\n        type: 1\n      });\n    } else if (arr[i].type === 0) {\n      if (typeof stack[stack.length - 1].type === \"undefined\") {\n        stack[stack.length - 1].value.push(arr[i]);\n      } else stack[stack.length - 1].value = arr[i].value(stack[stack.length - 1].value);\n    } else if (arr[i].type === 7) {\n      if (typeof stack[stack.length - 1].type === \"undefined\") {\n        stack[stack.length - 1].value.push(arr[i]);\n      } else stack[stack.length - 1].value = arr[i].value(stack[stack.length - 1].value);\n    } else if (arr[i].type === 8) {\n      pop1 = stack.pop();\n      pop2 = stack.pop();\n      stack.push({\n        type: 1,\n        value: arr[i].value(pop2.value, pop1.value)\n      });\n    } else if (arr[i].type === 10) {\n      pop1 = stack.pop();\n      pop2 = stack.pop();\n\n      if (typeof pop2.type === \"undefined\") {\n        pop2.value = pop2.concat(pop1);\n        pop2.value.push(arr[i]);\n        stack.push(pop2);\n      } else if (typeof pop1.type === \"undefined\") {\n        pop1.unshift(pop2);\n        pop1.push(arr[i]);\n        stack.push(pop1);\n      } else {\n        stack.push({\n          type: 1,\n          value: arr[i].value(pop2.value, pop1.value)\n        });\n      }\n    } else if (arr[i].type === 2 || arr[i].type === 9) {\n      pop1 = stack.pop();\n      pop2 = stack.pop();\n\n      if (typeof pop2.type === \"undefined\") {\n        console.log(pop2);\n        pop2 = pop2.concat(pop1);\n        pop2.push(arr[i]);\n        stack.push(pop2);\n      } else if (typeof pop1.type === \"undefined\") {\n        pop1.unshift(pop2);\n        pop1.push(arr[i]);\n        stack.push(pop1);\n      } else {\n        stack.push({\n          type: 1,\n          value: arr[i].value(pop2.value, pop1.value)\n        });\n      }\n    } else if (arr[i].type === 12) {\n      pop1 = stack.pop();\n\n      if (typeof pop1.type !== \"undefined\") {\n        pop1 = [pop1];\n      }\n\n      pop2 = stack.pop();\n      pop3 = stack.pop();\n      stack.push({\n        type: 1,\n        value: arr[i].value(pop3.value, pop2.value, new Mexp(pop1))\n      });\n    } else if (arr[i].type === 13) {\n      if (bool) {\n        stack.push({\n          value: UserDefined[arr[i].value],\n          type: 3\n        });\n      } else stack.push([arr[i]]);\n    }\n  }\n\n  if (stack.length > 1) {\n    throw new Mexp.exception(\"Uncaught Syntax error\");\n  }\n\n  return stack[0].value > 1000000000000000 ? \"Infinity\" : parseFloat(stack[0].value.toFixed(15));\n};\n\nMexp.eval = function (str, tokens, obj) {\n  if (typeof tokens === \"undefined\") {\n    return this.lex(str).toPostfix().postfixEval();\n  } else if (typeof obj === \"undefined\") {\n    if (typeof tokens.length !== \"undefined\") return this.lex(str, tokens).toPostfix().postfixEval();else return this.lex(str).toPostfix().postfixEval(tokens);\n  } else return this.lex(str, tokens).toPostfix().postfixEval(obj);\n};\n\nmodule.exports = Mexp;","map":{"version":3,"sources":["/usr/share/pgn-chess/node_modules/math-expression-evaluator/src/postfix_evaluator.js"],"names":["Mexp","require","prototype","postfixEval","UserDefined","PI","Math","E","stack","pop1","pop2","pop3","disp","temp","arr","value","bool","n","i","length","type","push","pop","concat","unshift","console","log","exception","parseFloat","toFixed","eval","str","tokens","obj","lex","toPostfix","module","exports"],"mappings":"AAAA,IAAIA,IAAI,GAACC,OAAO,CAAC,cAAD,CAAhB;;AACAD,IAAI,CAACE,SAAL,CAAeC,WAAf,GAA6B,UAAUC,WAAV,EAAuB;AACnD;;AACAA,EAAAA,WAAW,GAACA,WAAW,IAAE,EAAzB;AACAA,EAAAA,WAAW,CAACC,EAAZ,GAAeC,IAAI,CAACD,EAApB;AACAD,EAAAA,WAAW,CAACG,CAAZ,GAAcD,IAAI,CAACC,CAAnB;AACA,MAAIC,KAAK,GAAC,EAAV;AAAA,MAAaC,IAAb;AAAA,MAAkBC,IAAlB;AAAA,MAAuBC,IAAvB;AACA,MAAIC,IAAI,GAAC,EAAT;AACA,MAAIC,IAAI,GAAC,EAAT;AACA,MAAIC,GAAG,GAAC,KAAKC,KAAb;AACA,MAAIC,IAAI,GAAE,OAAOZ,WAAW,CAACa,CAAnB,KAAuB,WAAjC;;AACA,OAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACJ,GAAG,CAACK,MAAlB,EAAyBD,CAAC,EAA1B,EAA6B;AAC5B,QAAGJ,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAjB,EAAmB;AAClBZ,MAAAA,KAAK,CAACa,IAAN,CAAW;AAACN,QAAAA,KAAK,EAACD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAd;AAAoBK,QAAAA,IAAI,EAAC;AAAzB,OAAX;AACA,KAFD,MAGK,IAAGN,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAjB,EAAmB;AACvBZ,MAAAA,KAAK,CAACa,IAAN,CAAW;AAACN,QAAAA,KAAK,EAACX,WAAW,CAACU,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAR,CAAlB;AAAiCK,QAAAA,IAAI,EAAC;AAAtC,OAAX;AACA,KAFI,MAGA,IAAGN,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAjB,EAAmB;AACvB,UAAG,OAAOZ,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBC,IAA7B,KAAoC,WAAvC,EAAmD;AAClDZ,QAAAA,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAtB,CAA4BM,IAA5B,CAAiCP,GAAG,CAACI,CAAD,CAApC;AACA,OAFD,MAGKV,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAtB,GAA4BD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaP,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAnC,CAA5B;AACL,KALI,MAMA,IAAGD,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAjB,EAAmB;AACvB,UAAG,OAAOZ,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBC,IAA7B,KAAoC,WAAvC,EAAmD;AAClDZ,QAAAA,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAtB,CAA4BM,IAA5B,CAAiCP,GAAG,CAACI,CAAD,CAApC;AACA,OAFD,MAGKV,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAtB,GAA4BD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaP,KAAK,CAACA,KAAK,CAACW,MAAN,GAAa,CAAd,CAAL,CAAsBJ,KAAnC,CAA5B;AACL,KALI,MAMA,IAAGD,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAjB,EAAmB;AACvBX,MAAAA,IAAI,GAACD,KAAK,CAACc,GAAN,EAAL;AACAZ,MAAAA,IAAI,GAACF,KAAK,CAACc,GAAN,EAAL;AACAd,MAAAA,KAAK,CAACa,IAAN,CAAW;AAACD,QAAAA,IAAI,EAAC,CAAN;AAAQL,QAAAA,KAAK,EAACD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaL,IAAI,CAACK,KAAlB,EAAwBN,IAAI,CAACM,KAA7B;AAAd,OAAX;AACA,KAJI,MAKA,IAAGD,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,EAAjB,EAAoB;AACxBX,MAAAA,IAAI,GAACD,KAAK,CAACc,GAAN,EAAL;AACAZ,MAAAA,IAAI,GAACF,KAAK,CAACc,GAAN,EAAL;;AACA,UAAG,OAAOZ,IAAI,CAACU,IAAZ,KAAmB,WAAtB,EAAkC;AACjCV,QAAAA,IAAI,CAACK,KAAL,GAAWL,IAAI,CAACa,MAAL,CAAYd,IAAZ,CAAX;AACAC,QAAAA,IAAI,CAACK,KAAL,CAAWM,IAAX,CAAgBP,GAAG,CAACI,CAAD,CAAnB;AACAV,QAAAA,KAAK,CAACa,IAAN,CAAWX,IAAX;AACA,OAJD,MAKK,IAAI,OAAOD,IAAI,CAACW,IAAZ,KAAmB,WAAvB,EAAoC;AACxCX,QAAAA,IAAI,CAACe,OAAL,CAAad,IAAb;AACAD,QAAAA,IAAI,CAACY,IAAL,CAAUP,GAAG,CAACI,CAAD,CAAb;AACAV,QAAAA,KAAK,CAACa,IAAN,CAAWZ,IAAX;AACA,OAJI,MAKD;AACHD,QAAAA,KAAK,CAACa,IAAN,CAAW;AAACD,UAAAA,IAAI,EAAC,CAAN;AAAQL,UAAAA,KAAK,EAACD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaL,IAAI,CAACK,KAAlB,EAAwBN,IAAI,CAACM,KAA7B;AAAd,SAAX;AACS;AACV,KAhBI,MAiBA,IAAGD,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAd,IAAiBN,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,CAAlC,EAAoC;AACxCX,MAAAA,IAAI,GAACD,KAAK,CAACc,GAAN,EAAL;AACAZ,MAAAA,IAAI,GAACF,KAAK,CAACc,GAAN,EAAL;;AACA,UAAG,OAAOZ,IAAI,CAACU,IAAZ,KAAmB,WAAtB,EAAkC;AACrBK,QAAAA,OAAO,CAACC,GAAR,CAAYhB,IAAZ;AACZA,QAAAA,IAAI,GAACA,IAAI,CAACa,MAAL,CAAYd,IAAZ,CAAL;AACAC,QAAAA,IAAI,CAACW,IAAL,CAAUP,GAAG,CAACI,CAAD,CAAb;AACAV,QAAAA,KAAK,CAACa,IAAN,CAAWX,IAAX;AACA,OALD,MAMK,IAAI,OAAOD,IAAI,CAACW,IAAZ,KAAmB,WAAvB,EAAoC;AACxCX,QAAAA,IAAI,CAACe,OAAL,CAAad,IAAb;AACAD,QAAAA,IAAI,CAACY,IAAL,CAAUP,GAAG,CAACI,CAAD,CAAb;AACAV,QAAAA,KAAK,CAACa,IAAN,CAAWZ,IAAX;AACA,OAJI,MAKD;AACHD,QAAAA,KAAK,CAACa,IAAN,CAAW;AAACD,UAAAA,IAAI,EAAC,CAAN;AAAQL,UAAAA,KAAK,EAACD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaL,IAAI,CAACK,KAAlB,EAAwBN,IAAI,CAACM,KAA7B;AAAd,SAAX;AACA;AACD,KAjBI,MAkBA,IAAGD,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,EAAjB,EAAoB;AACxBX,MAAAA,IAAI,GAACD,KAAK,CAACc,GAAN,EAAL;;AACA,UAAI,OAAOb,IAAI,CAACW,IAAZ,KAAmB,WAAvB,EAAoC;AACnCX,QAAAA,IAAI,GAAC,CAACA,IAAD,CAAL;AACA;;AACDC,MAAAA,IAAI,GAACF,KAAK,CAACc,GAAN,EAAL;AACAX,MAAAA,IAAI,GAACH,KAAK,CAACc,GAAN,EAAL;AACAd,MAAAA,KAAK,CAACa,IAAN,CAAW;AAACD,QAAAA,IAAI,EAAC,CAAN;AAAQL,QAAAA,KAAK,EAACD,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAP,CAAaJ,IAAI,CAACI,KAAlB,EAAwBL,IAAI,CAACK,KAA7B,EAAmC,IAAIf,IAAJ,CAASS,IAAT,CAAnC;AAAd,OAAX;AACA,KARI,MASA,IAAGK,GAAG,CAACI,CAAD,CAAH,CAAOE,IAAP,KAAc,EAAjB,EAAoB;AACxB,UAAGJ,IAAH,EAAQ;AACPR,QAAAA,KAAK,CAACa,IAAN,CAAW;AAACN,UAAAA,KAAK,EAACX,WAAW,CAACU,GAAG,CAACI,CAAD,CAAH,CAAOH,KAAR,CAAlB;AAAiCK,UAAAA,IAAI,EAAC;AAAtC,SAAX;AACA,OAFD,MAGKZ,KAAK,CAACa,IAAN,CAAW,CAACP,GAAG,CAACI,CAAD,CAAJ,CAAX;AACL;AACD;;AACD,MAAIV,KAAK,CAACW,MAAN,GAAa,CAAjB,EAAoB;AACnB,UAAM,IAAInB,IAAI,CAAC2B,SAAT,CAAmB,uBAAnB,CAAN;AACA;;AACD,SAAOnB,KAAK,CAAC,CAAD,CAAL,CAASO,KAAT,GAAe,gBAAf,GAAgC,UAAhC,GAA2Ca,UAAU,CAACpB,KAAK,CAAC,CAAD,CAAL,CAASO,KAAT,CAAec,OAAf,CAAuB,EAAvB,CAAD,CAA5D;AACA,CAzFD;;AA0FA7B,IAAI,CAAC8B,IAAL,GAAU,UAASC,GAAT,EAAaC,MAAb,EAAoBC,GAApB,EAAwB;AACjC,MAAI,OAAOD,MAAP,KAAgB,WAApB,EAAiC;AAChC,WAAO,KAAKE,GAAL,CAASH,GAAT,EAAcI,SAAd,GAA0BhC,WAA1B,EAAP;AACA,GAFD,MAGK,IAAI,OAAO8B,GAAP,KAAa,WAAjB,EAA8B;AAClC,QAAI,OAAOD,MAAM,CAACb,MAAd,KAAuB,WAA3B,EACC,OAAO,KAAKe,GAAL,CAASH,GAAT,EAAaC,MAAb,EAAqBG,SAArB,GAAiChC,WAAjC,EAAP,CADD,KAGC,OAAO,KAAK+B,GAAL,CAASH,GAAT,EAAcI,SAAd,GAA0BhC,WAA1B,CAAsC6B,MAAtC,CAAP;AACD,GALI,MAOJ,OAAO,KAAKE,GAAL,CAASH,GAAT,EAAaC,MAAb,EAAqBG,SAArB,GAAiChC,WAAjC,CAA6C8B,GAA7C,CAAP;AACD,CAZD;;AAaAG,MAAM,CAACC,OAAP,GAAerC,IAAf","sourcesContent":["var Mexp=require('./postfix.js');\r\nMexp.prototype.postfixEval = function (UserDefined) {\r\n\t'use strict';\r\n\tUserDefined=UserDefined||{};\r\n\tUserDefined.PI=Math.PI;\r\n\tUserDefined.E=Math.E;\r\n\tvar stack=[],pop1,pop2,pop3;\r\n\tvar disp=[];\r\n\tvar temp='';\r\n\tvar arr=this.value;\r\n\tvar bool=(typeof UserDefined.n!==\"undefined\");\r\n\tfor(var i=0;i<arr.length;i++){\r\n\t\tif(arr[i].type===1){\r\n\t\t\tstack.push({value:arr[i].value,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===3){\r\n\t\t\tstack.push({value:UserDefined[arr[i].value],type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===0){\r\n\t\t\tif(typeof stack[stack.length-1].type===\"undefined\"){\r\n\t\t\t\tstack[stack.length-1].value.push(arr[i]);\r\n\t\t\t}\r\n\t\t\telse stack[stack.length-1].value=arr[i].value(stack[stack.length-1].value);\r\n\t\t}\r\n\t\telse if(arr[i].type===7){\r\n\t\t\tif(typeof stack[stack.length-1].type===\"undefined\"){\r\n\t\t\t\tstack[stack.length-1].value.push(arr[i]);\r\n\t\t\t}\r\n\t\t\telse stack[stack.length-1].value=arr[i].value(stack[stack.length-1].value);\r\n\t\t}\r\n\t\telse if(arr[i].type===8){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n\t\t}\r\n\t\telse if(arr[i].type===10){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tif(typeof pop2.type===\"undefined\"){\r\n\t\t\t\tpop2.value=pop2.concat(pop1);\r\n\t\t\t\tpop2.value.push(arr[i]);\r\n\t\t\t\tstack.push(pop2);\r\n\t\t\t}\r\n\t\t\telse if (typeof pop1.type===\"undefined\") {\r\n\t\t\t\tpop1.unshift(pop2);\r\n\t\t\t\tpop1.push(arr[i]);\r\n\t\t\t\tstack.push(pop1);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n            }\r\n\t\t}\r\n\t\telse if(arr[i].type===2||arr[i].type===9){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tif(typeof pop2.type===\"undefined\"){\r\n                console.log(pop2);\r\n\t\t\t\tpop2=pop2.concat(pop1);\r\n\t\t\t\tpop2.push(arr[i]);\r\n\t\t\t\tstack.push(pop2);\r\n\t\t\t}\r\n\t\t\telse if (typeof pop1.type===\"undefined\") {\r\n\t\t\t\tpop1.unshift(pop2);\r\n\t\t\t\tpop1.push(arr[i]);\r\n\t\t\t\tstack.push(pop1);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tstack.push({type:1,value:arr[i].value(pop2.value,pop1.value)});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(arr[i].type===12){\r\n\t\t\tpop1=stack.pop();\r\n\t\t\tif (typeof pop1.type!==\"undefined\") {\r\n\t\t\t\tpop1=[pop1];\r\n\t\t\t}\r\n\t\t\tpop2=stack.pop();\r\n\t\t\tpop3=stack.pop();\r\n\t\t\tstack.push({type:1,value:arr[i].value(pop3.value,pop2.value,new Mexp(pop1))});\r\n\t\t}\r\n\t\telse if(arr[i].type===13){\r\n\t\t\tif(bool){\r\n\t\t\t\tstack.push({value:UserDefined[arr[i].value],type:3});\r\n\t\t\t}\r\n\t\t\telse stack.push([arr[i]]);\r\n\t\t}\r\n\t}\r\n\tif (stack.length>1) {\r\n\t\tthrow(new Mexp.exception(\"Uncaught Syntax error\"));\r\n\t}\r\n\treturn stack[0].value>1000000000000000?\"Infinity\":parseFloat(stack[0].value.toFixed(15));\r\n};\r\nMexp.eval=function(str,tokens,obj){\r\n\tif (typeof tokens===\"undefined\") {\r\n\t\treturn this.lex(str).toPostfix().postfixEval();\r\n\t}\r\n\telse if (typeof obj===\"undefined\") {\r\n\t\tif (typeof tokens.length!==\"undefined\") \r\n\t\t\treturn this.lex(str,tokens).toPostfix().postfixEval();\r\n\t\telse\r\n\t\t\treturn this.lex(str).toPostfix().postfixEval(tokens);\r\n\t}\r\n\telse\r\n\t\treturn this.lex(str,tokens).toPostfix().postfixEval(obj);\r\n};\r\nmodule.exports=Mexp;"]},"metadata":{},"sourceType":"script"}