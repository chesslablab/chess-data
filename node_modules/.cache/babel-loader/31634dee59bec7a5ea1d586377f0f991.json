{"ast":null,"code":"var Mexp = require('./postfix_evaluator.js');\n\nMexp.prototype.formulaEval = function () {\n  \"use strict\";\n\n  var stack = [],\n      pop1,\n      pop2,\n      pop3;\n  var disp = [];\n  var temp = '';\n  var arr = this.value;\n\n  for (var i = 0; i < arr.length; i++) {\n    if (arr[i].type === 1 || arr[i].type === 3) {\n      disp.push({\n        value: arr[i].type === 3 ? arr[i].show : arr[i].value,\n        type: 1\n      });\n    } else if (arr[i].type === 13) {\n      disp.push({\n        value: arr[i].show,\n        type: 1\n      });\n    } else if (arr[i].type === 0) {\n      disp[disp.length - 1] = {\n        value: arr[i].show + (arr[i].show != \"-\" ? \"(\" : \"\") + disp[disp.length - 1].value + (arr[i].show != \"-\" ? \")\" : \"\"),\n        type: 0\n      };\n    } else if (arr[i].type === 7) {\n      disp[disp.length - 1] = {\n        value: (disp[disp.length - 1].type != 1 ? \"(\" : \"\") + disp[disp.length - 1].value + (disp[disp.length - 1].type != 1 ? \")\" : \"\") + arr[i].show,\n        type: 7\n      };\n    } else if (arr[i].type === 10) {\n      pop1 = disp.pop();\n      pop2 = disp.pop();\n      if (arr[i].show === 'P' || arr[i].show === 'C') disp.push({\n        value: \"<sup>\" + pop2.value + \"</sup>\" + arr[i].show + \"<sub>\" + pop1.value + \"</sub>\",\n        type: 10\n      });else disp.push({\n        value: (pop2.type != 1 ? \"(\" : \"\") + pop2.value + (pop2.type != 1 ? \")\" : \"\") + \"<sup>\" + pop1.value + \"</sup>\",\n        type: 1\n      });\n    } else if (arr[i].type === 2 || arr[i].type === 9) {\n      pop1 = disp.pop();\n      pop2 = disp.pop();\n      disp.push({\n        value: (pop2.type != 1 ? \"(\" : \"\") + pop2.value + (pop2.type != 1 ? \")\" : \"\") + arr[i].show + (pop1.type != 1 ? \"(\" : \"\") + pop1.value + (pop1.type != 1 ? \")\" : \"\"),\n        type: arr[i].type\n      });\n    } else if (arr[i].type === 12) {\n      pop1 = disp.pop();\n      pop2 = disp.pop();\n      pop3 = disp.pop();\n      disp.push({\n        value: arr[i].show + \"(\" + pop3.value + \",\" + pop2.value + \",\" + pop1.value + \")\",\n        type: 12\n      });\n    }\n  }\n\n  return disp[0].value;\n};\n\nmodule.exports = Mexp;","map":{"version":3,"sources":["/usr/share/pgn-chess/node_modules/math-expression-evaluator/src/formula_evaluator.js"],"names":["Mexp","require","prototype","formulaEval","stack","pop1","pop2","pop3","disp","temp","arr","value","i","length","type","push","show","pop","module","exports"],"mappings":"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","sourcesContent":["var Mexp=require('./postfix_evaluator.js');\r\nMexp.prototype.formulaEval = function () {\r\n\t\"use strict\";\r\n\tvar stack=[],pop1,pop2,pop3;\r\n\tvar disp=[];\r\n\tvar temp='';\r\n\tvar arr=this.value;\r\n\tfor(var i=0;i<arr.length;i++){\r\n\t\tif(arr[i].type===1||arr[i].type===3){\r\n\t\t\tdisp.push({value:arr[i].type===3?arr[i].show:arr[i].value,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===13){\r\n\t\t\tdisp.push({value:arr[i].show,type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===0){\r\n\t\t\tdisp[disp.length-1]={value:arr[i].show+(arr[i].show!=\"-\"?\"(\":\"\")+disp[disp.length-1].value+(arr[i].show!=\"-\"?\")\":\"\"),type:0};\r\n\t\t}\r\n\t\telse if(arr[i].type===7){\r\n\t\t\tdisp[disp.length-1]={value:(disp[disp.length-1].type!=1?\"(\":\"\")+disp[disp.length-1].value+(disp[disp.length-1].type!=1?\")\":\"\")+arr[i].show,type:7};\r\n\t\t}\r\n\t\telse if(arr[i].type===10){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tif(arr[i].show==='P'||arr[i].show==='C')disp.push({value:\"<sup>\"+pop2.value+\"</sup>\"+arr[i].show+\"<sub>\"+pop1.value+\"</sub>\",type:10});\r\n\t\t\telse disp.push({value:(pop2.type!=1?\"(\":\"\")+pop2.value+(pop2.type!=1?\")\":\"\")+\"<sup>\"+pop1.value+\"</sup>\",type:1});\r\n\t\t}\r\n\t\telse if(arr[i].type===2||arr[i].type===9){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tdisp.push({value:(pop2.type!=1?\"(\":\"\")+pop2.value+(pop2.type!=1?\")\":\"\")+arr[i].show+(pop1.type!=1?\"(\":\"\")+pop1.value+(pop1.type!=1?\")\":\"\"),type:arr[i].type});\r\n\t\t}\r\n\t\telse if(arr[i].type===12){\r\n\t\t\tpop1=disp.pop();\r\n\t\t\tpop2=disp.pop();\r\n\t\t\tpop3=disp.pop();\r\n\t\t\tdisp.push({value:arr[i].show+\"(\"+pop3.value+\",\"+pop2.value+\",\"+pop1.value+\")\",type:12});\r\n\t\t}\r\n\t}\r\n\treturn disp[0].value;\r\n};\r\nmodule.exports=Mexp;"]},"metadata":{},"sourceType":"script"}